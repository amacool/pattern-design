(this["webpackJsonpdesign-manipulation"]=this["webpackJsonpdesign-manipulation"]||[]).push([[0],{11:function(e,t,s){e.exports=s(19)},16:function(e,t,s){},17:function(e,t,s){},18:function(e,t,s){},19:function(e,t,s){"use strict";s.r(t);var o=s(0),i=s.n(o),n=s(8),r=s.n(n),c=(s(16),s(6)),a=s(1),l=s(4),p=s(9),h=s(10),X=function e(){var t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:0,color:"white",selected:!1,lineColor:"white",lineWidth:1,lineStyle:0,vertexLen:1,vertices:[{posX:0,posY:0}]},o=s.type,i=s.color,n=s.selected,r=s.lineColor,c=s.lineWidth,l=s.lineStyle,X=s.vertexLen,u=s.vertices;Object(h.a)(this,e),this.type=-1,this.color="white",this.text="",this.fontFamily="Arial",this.fontSize=15,this.selected=!1,this.lineColor="white",this.lineWidth=0,this.lineStyle=-1,this.vertexLen=0,this.vertices=[],this.getIntersectionWithPanel=function(e,t,s){var o=t.posX-e.posX,i=e.posY-t.posY,n=o/i*(s.height-t.posY);return[{posX:t.posX-n,posY:s.height},{posX:t.posX+o/i*t.posY,posY:0}]},this.copyProperties=function(e){var s={};return Object.keys(Object(a.a)({},e)).forEach((function(o){"function"!==typeof e[o]&&e[o]&&(t[o]=e[o],s[o]=e[o])})),s},this.drawVertex=function(e,s){if(t.selected){var o=1e11,i=0,n=1e11,r=0;t.vertices.forEach((function(c){var a=t.lineWidth<5?5:t.lineWidth,l=c.selected?a+3:a+1;e.beginPath(),e.fillStyle="white",e.ellipse(c.posX,c.posY,l,l,0,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="black",e.ellipse(c.posX,c.posY,l-2,l-2,0,0,2*Math.PI),e.fill(),7!==t.type&&10!==t.type&&c.selected&&(e.lineWidth=.5,e.setLineDash([5,5]),e.strokeStyle="white",e.moveTo(c.posX,c.posY),e.lineTo(s.width,c.posY),e.moveTo(c.posX,c.posY),e.lineTo(c.posX,s.height),e.stroke(),e.setLineDash([])),o=o<c.posX?o:c.posX,i=i>c.posX?i:c.posX,n=n<c.posY?n:c.posY,r=r>c.posY?r:c.posY}))}},this.fillRegion=function(e,s,o){o.beginPath(),t.lineStyle?o.setLineDash([4,2]):o.setLineDash([]),o.fillStyle=s,o.globalAlpha=.2,o.moveTo(e[0].posX,e[0].posY);for(var i=1;i<e.length;i++)o.lineTo(e[i].posX,e[i].posY);o.closePath(),o.fill(),o.globalAlpha=1},this.getPitchforkDrawPoints=function(e,s,o,i){var n={posX:(s.posX+o.posX)/2,posY:(s.posY+o.posY)/2},r={posX:(o.posX+n.posX)/2,posY:(o.posY+n.posY)/2},c={posX:(s.posX+n.posX)/2,posY:(s.posY+n.posY)/2},a={posX:r.posX+(r.posX-e.posX),posY:r.posY-(e.posY-r.posY)},l={posX:s.posX+(n.posX-e.posX),posY:s.posY-(e.posY-n.posY)},p={posX:a.posX+(r.posX-o.posX),posY:a.posY+(r.posY-o.posY)},h={posX:l.posX-(s.posX-c.posX),posY:l.posY-(s.posY-c.posY)},X=t.getIntersectionWithPanel(o,a,i),u=e.posY>n.posY?X[1]:X[0],d=t.getIntersectionWithPanel(s,l,i);return{X4:n,X5:r,X6:c,X7:a,X8:l,X9:p,X10:h,X11:u,X12:e.posY>n.posY?d[1]:d[0]}},this.getChannelDrawPoints=function(e,t,s){var o=s.posX-e.posX,i=e.posY-s.posY,n=t.posX-e.posX,r=e.posY-t.posY;if(0===n)return{X4:s,X5:s};var c=i-o/n*r;return{X4:{posX:e.posX,posY:e.posY-c},X5:{posX:t.posX,posY:t.posY-c}}},this.drawSegmentObject=function(e,s,o,i){o?i.setLineDash([4,2]):i.setLineDash([]),i.beginPath(),i.strokeStyle=t.lineColor,i.lineWidth=s;var n=e[0],r=e[1];i.moveTo(n.posX,n.posY),i.lineTo(r.posX,r.posY),i.stroke()},this.drawTrendLineObject=function(e,s){t.lineStyle?e.setLineDash([4,2]):e.setLineDash([]),e.beginPath(),e.strokeStyle=t.lineColor,e.lineWidth=t.lineWidth;var o=t.vertices[0],i=t.vertices[1],n=t.getIntersectionWithPanel(o,i,s),r=n[0],c=n[1];e.moveTo(r.posX,r.posY),e.lineTo(c.posX,c.posY),e.stroke()},this.drawRayLineObject=function(e,s,o){t.lineStyle?s.setLineDash([4,2]):s.setLineDash([]),s.beginPath(),s.strokeStyle=t.lineColor,s.lineWidth=t.lineWidth;var i=e[0],n=e[1],r=t.getIntersectionWithPanel(i,n,o),c=r[0],a=r[1];s.moveTo(i.posX,i.posY),n.posY<i.posY?s.lineTo(a.posX,a.posY):s.lineTo(c.posX,c.posY),s.stroke()},this.drawArrowObject=function(e){t.lineStyle?e.setLineDash([4,2]):e.setLineDash([]),e.beginPath(),e.strokeStyle=t.lineColor,e.lineWidth=t.lineWidth;var s=t.vertices[0],o=t.vertices[1],i=o.posX-s.posX,n=s.posY-o.posY,r=Math.atan(n/i),c=Math.PI/8,a=s.posX<o.posX?1:-1,l={posX:o.posX-20*a*Math.cos(r+c),posY:o.posY+20*a*Math.sin(r+c)},p={posX:o.posX-20*a*Math.cos(r-c),posY:o.posY+20*a*Math.sin(r-c)};e.moveTo(s.posX,s.posY),e.lineTo(o.posX,o.posY),e.moveTo(o.posX,o.posY),e.lineTo(l.posX,l.posY),e.moveTo(o.posX,o.posY),e.lineTo(p.posX,p.posY),e.stroke()},this.drawPolygonObject=function(e){t.lineStyle?e.setLineDash([4,2]):e.setLineDash([]),e.beginPath(),e.strokeStyle=t.lineColor,e.lineWidth=t.lineWidth,e.moveTo(t.vertices[0].posX,t.vertices[0].posY);for(var s=1;s<t.vertices.length;s++){var o=t.vertices[s];e.lineTo(o.posX,o.posY)}if(e.closePath(),e.stroke(),e.fillStyle="#E5EEFF",e.fill(),t.selected){var i,n=Object(p.a)(t.vertices);try{for(n.s();!(i=n.n()).done;){var r=i.value,c=r.selected?2*t.lineWidth:2*t.lineWidth-2;e.beginPath(),e.fillStyle="white",e.ellipse(r.posX,r.posY,c,c,0,0,2*Math.PI),e.fill(),e.beginPath(),e.fillStyle="black",e.ellipse(r.posX,r.posY,c-2,c-2,0,0,2*Math.PI),e.fill()}}catch(a){n.e(a)}finally{n.f()}}},this.drawPitchforkObject=function(e,s){if(t.vertices.length<3)t.drawRayLineObject(t.vertices,e,s);else{var o=t.vertices[0],i=t.vertices[1],n=t.vertices[2],r=t.getPitchforkDrawPoints(o,i,n,s),c=r.X4,a=r.X5,l=r.X6,p=r.X7,h=r.X8,X=r.X9,u=r.X10,d=r.X11,f=r.X12;t.drawSegmentObject([i,n],t.lineWidth,t.lineStyle,e),t.drawRayLineObject([o,c],e,s),t.drawRayLineObject([n,p],e,s),t.drawRayLineObject([i,h],e,s),t.drawRayLineObject([a,X],e,s),t.drawRayLineObject([l,u],e,s),t.fillRegion([n,i,f,d],t.lineColor,e)}},this.drawTextObject=function(e){var s=t.vertices[0];e.textBaseline="top",e.fillStyle=t.color,e.font="".concat(t.fontSize,"px ").concat(t.fontFamily),e.fillText(t.text,s.posX,s.posY)},this.drawChannel=function(e){e.setLineDash([]),e.beginPath(),e.strokeStyle=t.lineColor,e.lineWidth=t.lineWidth;var s=t.vertices[0],o=t.vertices[1];if(t.drawSegmentObject([s,o],t.lineWidth,t.lineStyle,e),3===t.vertices.length){var i=t.vertices[2],n=t.getChannelDrawPoints(s,o,i),r=n.X4,c=n.X5;i.posX=(r.posX+c.posX)/2,i.posY=(r.posY+c.posY)/2,t.drawSegmentObject([r,c],t.lineWidth,t.lineStyle,e),t.fillRegion([s,o,c,r],t.lineColor,e)}},this.drawFibonacci=function(e){e.setLineDash([]),e.beginPath(),e.fillStyle=t.color,e.font="12px ".concat(t.fontFamily);var s=t.vertices[0],o=t.vertices[1],i={posX:o.posX,posY:s.posY},n={posX:s.posX,posY:o.posY},r=s.posY-o.posY,c=Math.min(s.pair.realVal,o.pair.realVal),a=Math.max(s.pair.realVal,o.pair.realVal),l=[.236,.382,.5,.618,.764],p=["#E9C9C9","#DEE9C9","#C9E9DE","#C9DEE9","#DEE9C9","#E9C9C9"],h={},X={};l.forEach((function(u,d){var f={posX:s.posX,posY:o.posY+u*r},v={posX:o.posX,posY:o.posY+u*r};t.drawSegmentObject([f,v],1,0,e),0===d?t.fillRegion([o,n,f,v],p[d],e):t.fillRegion([X,h,f,v],p[d],e),d===l.length-1&&t.fillRegion([i,s,f,v],p[0],e);var Y=s.posY>o.posY?u:1-u,g=a-(a-c)*Y;e.fillText("".concat(u.toFixed(3)," (").concat(g.toFixed(2),")"),Math.min(f.posX,v.posX)-100,f.posY),h=f,X=v})),e.fillText("1",Math.min(s.posX,i.posX)-50,s.posY),e.fillText("0",Math.min(n.posX,o.posX)-50,o.posY),t.drawSegmentObject([s,o],1,1,e),e.lineWidth=t.lineWidth,t.drawSegmentObject([s,i],t.lineWidth,0,e),t.drawSegmentObject([n,o],t.lineWidth,0,e)},this.drawObject=function(e,s){2===t.type?t.drawArrowObject(e):3===t.type?t.drawRayLineObject(t.vertices,e,s):4===t.type||5===t.type?t.drawTrendLineObject(e,s):6===t.type?t.drawPitchforkObject(e,s):7===t.type?t.drawTextObject(e):8===t.type?t.drawChannel(e):9===t.type?t.drawFibonacci(e):10===t.type&&t.drawPolygonObject(e),7!==t.type&&t.drawVertex(e,s)},this.setVertex=function(e,s,o,i){var n=t.vertices[e];if(8===t.type&&e<2&&3===t.vertices.length){var r=t.vertices[0],c=t.vertices[1],a=t.vertices[2],l=t.getChannelDrawPoints(r,c,a),p=l.X4,h=l.X5;0===e?(a.posX=(h.posX+p.posX-(n.posX-s))/2,a.posY=(h.posY+p.posY-(n.posY-o))/2):(a.posX=(p.posX+h.posX-(n.posX-s))/2,a.posY=(p.posY+h.posY-(n.posY-o))/2)}n.posX=s,n.posY=o,n.pair=i},this.selectVertex=function(e,s){t.vertices[s].selected=e},this.selectVertices=function(e){t.vertices.forEach((function(t){t.selected=e}))},this.moveVertices=function(e,s,o,i,n){t.vertices.forEach((function(t){t.posX=t.posX+e,t.posY=t.posY+s}))},this.scaleMoveVertices=function(e,s,o,i,n,r,c,a,l){t.vertices.forEach((function(t){t.posX=i-(i-t.posX)*e,t.posY=n+(t.posY-n)*s,t.posY=r-(r-t.posY)*o}))},this.selectMyself=function(e,s){t.selected=e,s&&t.selectVertices(e)},this.getLineBounding=function(e,s){var o=s.posX-e.posX,i=e.posY-s.posY,n=Math.atan(i/o),r=t.lineWidth/2*Math.sin(n),c=t.lineWidth/2*Math.cos(n);return[{posX:e.posX-r,posY:e.posY-c},{posX:e.posX+r,posY:e.posY+c},{posX:s.posX+r,posY:s.posY+c},{posX:s.posX-r,posY:s.posY-c}]},this.isHitInPath=function(e,t,s,o){o.beginPath(),o.moveTo(s[0].posX,s[0].posY);for(var i=1;i<s.length;i++){var n=s[i];o.lineTo(n.posX,n.posY)}return o.closePath(),o.isPointInPath(e,t)},this.isHitOnSegment=function(e,s,o,i,n){var r=t.getLineBounding(o,i);return t.isHitInPath(e,s,r,n)},this.isHitOnRay=function(e,s,o,i,n,r){var c=t.getIntersectionWithPanel(o,i,r),a=c[0],l=c[1],p={};return p=i.posY<o.posY?t.getLineBounding(o,l):t.getLineBounding(o,a),t.isHitInPath(e,s,p,n)},this.isHitOnLine=function(e,s,o,i,n,r){var c=t.getIntersectionWithPanel(o,i,r),a=c[0],l=c[1],p=t.getLineBounding(a,l);return t.isHitInPath(e,s,p,n)},this.isHitOnEllipse=function(e,t,s){return Math.sqrt(Math.pow(e-s.posX,2)+Math.pow(t-s.posY,2))<s.radius},this.isHitOnObject=function(e,s,o,i){var n=-1,r=-1,c=!1;if(t.vertices.forEach((function(o,i){t.isHitOnEllipse(e,s,Object(a.a)(Object(a.a)({},o),{},{radius:2*t.lineWidth}))&&(n=i)})),2===t.type)c=t.isHitOnSegment(e,s,t.vertices[0],t.vertices[1],o);else if(3===t.type)c=t.isHitOnRay(e,s,t.vertices[0],t.vertices[1],o,i);else if(5===t.type||4===t.type)c=t.isHitOnLine(e,s,t.vertices[0],t.vertices[1],o,i);else if(6===t.type){var l=t.vertices[0],p=t.vertices[1],h=t.vertices[2],X=t.getPitchforkDrawPoints(l,p,h,i),u=X.X4,d=X.X5,f=X.X6,v=X.X7,Y=X.X8,g=X.X9,b=X.X10;c=t.isHitOnSegment(e,s,p,h,o)||t.isHitOnRay(e,s,l,u,o,i)||t.isHitOnRay(e,s,h,v,o,i)||t.isHitOnRay(e,s,p,Y,o,i)||t.isHitOnRay(e,s,d,g,o,i)||t.isHitOnRay(e,s,f,b,o,i)}else if(7===t.type){var m=t.vertices[0],O=t.text.length*t.fontSize,y=t.fontSize,S={posX:m.posX+O,posY:m.posY},j={posX:m.posX+O,posY:m.posY+y},w={posX:m.posX,posY:m.posY+y};c=t.isHitInPath(e,s,[m,S,j,w],o)}else if(8===t.type){var P=t.vertices[0],E=t.vertices[1],L=t.vertices[2],W=t.getChannelDrawPoints(P,E,L),C=W.X4,x=W.X5;c=t.isHitInPath(e,s,[P,E,x,C],o)}else if(9===t.type){var k=t.vertices[0],T=t.vertices[1],M={posX:T.posX,posY:k.posY},D={posX:k.posX,posY:T.posY};c=t.isHitOnSegment(e,s,k,M,o)||t.isHitOnSegment(e,s,T,D,o)}else 10===t.type&&(c=(r=t.vertices.findIndex((function(i,n){return t.isHitOnSegment(e,s,i,t.vertices[n>=t.vertices.length-1?0:n+1],o)})))>=0);return{selectedVertexTemp:n,isObjectSelected:c,selectedSegment:r}},this.type=o,this.color=i,this.selected=n,this.lineColor=r,this.lineWidth=c,this.lineStyle=l,this.vertexLen=X,this.vertices=u},u=s(2),d=s.n(u),f=(s(17),function(e){var t=e.settingValues,s=e.setSettingValues,n=Object(o.useState)(""),r=Object(l.a)(n,2),c=r[0],a=r[1];return Object(o.useEffect)((function(){a(t.width.toString())}),[t]),Object(o.useEffect)((function(){d()(".setting-modal-header").on("mousedown",(function(e){var t=e.pageX,s=e.pageY,o=d()(".setting-modal").css("top").slice(0,-2),i=d()(".setting-modal").css("left").slice(0,-2);d()(".setting-modal-header").on("mousemove",(function(e){var n=e.pageX,r=e.pageY;d()(".setting-modal").css("top",1*parseInt(o)+r-s+"px"),d()(".setting-modal").css("left",1*parseInt(i)+n-t+"px")}))})),d()(".setting-modal-header").on("mouseup",(function(){d()(".setting-modal-header").off("mousemove")}))})),i.a.createElement("div",{className:"setting-modal"},i.a.createElement("div",{className:"setting-modal-header"},i.a.createElement("h5",null,"Setting"),i.a.createElement("div",{className:"icon-close",onClick:function(){return s(!1,c)}})),i.a.createElement("div",{className:"setting-modal-body"},i.a.createElement("input",{value:c?Math.ceil(parseFloat(c)):0,onChange:function(e){return a(e.target.value)}})),i.a.createElement("div",{className:"setting-modal-footer"},i.a.createElement("button",{className:"btn-setting btn btn-primary",onClick:function(){return s(!0,c)}},"OK"),i.a.createElement("button",{className:"btn-close btn btn-secondary",onClick:function(){return s(!1,c)}},"Close")))});f.defaultProps={settingValues:{}};var v=[{posX:100,posY:100,selected:!1},{posX:300,posY:100,selected:!1},{posX:300,posY:300,selected:!1},{posX:100,posY:300,selected:!1}];var Y=function(){var e={width:800,height:800},t=Object(o.useState)(!1),s=Object(l.a)(t,2),n=s[0],r=s[1],p=Object(o.useState)({curSelectedSegment:-1,curSelectedObject:-1,curSelectedVertex:-1}),h=Object(l.a)(p,2),u=h[0],d=h[1],Y=Object(o.useState)({width:100}),g=Object(l.a)(Y,2),b=g[0],m=g[1],O=Object(o.useRef)([]),y=Object(o.useRef)(),S=Object(o.useRef)(),j=Object(o.useCallback)((function(){var e=document.querySelector("#custom-canvas"),t=window.devicePixelRatio||1,s=e.getBoundingClientRect();e.width=s.width*t,e.height=s.height*t;var o=e.getContext("2d");o.scale(t,t),y.current=o}),[]),w=Object(o.useCallback)((function(){y.current.clearRect(0,0,e.width,e.height),O.current.forEach((function(t){return t.drawObject(y.current,e)}))}),[e]),P=Object(o.useCallback)((function(){j(),w()}),[w,j]),E=Object(o.useCallback)((function(t){var s,o,i=t.layerX,n=t.layerY;s=!1,o=!0,O.current.forEach((function(e){return e.selectMyself(s,o)}));var l=function(e,t,s,o,i){for(var n=-1,r=-1,c=-1,a=0;a<s.length;a++){var l=s[a].isHitOnObject(e,t,o,i),p=l.selectedVertexTemp,h=l.isObjectSelected,X=l.selectedSegment;if(p>=0){r=p,n=a;break}if(!0===h){n=a,c=X;break}}return{selectedObject:n,selectedVertex:r,selectedSegment:c}}(i,n,O.current,y.current,e),p=l.selectedObject,h=l.selectedVertex,X=l.selectedSegment;if(p>=0){if(d(Object(a.a)(Object(a.a)({},u),{},{curSelectedObject:p})),O.current[p].selectMyself(!0,!1),h>=0)d(Object(a.a)(Object(a.a)({},u),{},{curSelectedObject:p,curSelectedVertex:h})),O.current[p].selectVertex(!0,h),w();else if(X>=0){d(Object(a.a)(Object(a.a)({},u),{},{curSelectedObject:p,curSelectedSegment:X}));var f=Object(c.a)(O.current[p].vertices),v=function(e,t){var s=e.posX-t.posX,o=e.posY-t.posY;return Math.sqrt(s*s+o*o)}(f[X],f[X>=f.length-1?0:X+1]);m(Object(a.a)(Object(a.a)({},b),{},{width:v})),r(!0)}}else r(!1)}),[e,b,u,w]);return Object(o.useEffect)((function(){var e=new X({type:10,color:"#fff",selected:!0,vertexLen:v.length,lineColor:"#000",lineWidth:5,lineStyle:0,vertices:v});return O.current.push(e),P(),S.current=document.querySelector("#custom-canvas"),S.current.addEventListener("click",E),function(){S.current.removeEventListener("click",E)}}),[E,P]),i.a.createElement("div",null,i.a.createElement("canvas",{id:"custom-canvas",style:e}),n&&i.a.createElement(f,{settingValues:b,setSettingValues:function(e,t){e&&function(e){var t=u.curSelectedSegment,s=u.curSelectedObject,o=Object(c.a)(O.current[s].vertices),i=o[t],n=o[t>=o.length-1?0:t+1];if(i.posX===n.posX){var r=i.posY<n.posY?1:-1;n.posY=i.posY+r*e}else if(i.posY===n.posY){var a=i.posX<n.posX?1:-1;n.posX=i.posX+a*e}o[t]=i,o[t>=o.length-1?0:t+1]=n,O.current[s].vertices=Object(c.a)(o),w()}(parseInt(t)),r(!1)}}))};s(18);var g=function(){return i.a.createElement("div",{className:"App"},i.a.createElement("header",{className:"App-header"},i.a.createElement(Y,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.dbccd825.chunk.js.map